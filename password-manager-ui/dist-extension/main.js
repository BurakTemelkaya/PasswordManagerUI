import{u as C,r,g as I,d as L,j as e,f as D,l as z,a as T,A as K,b as R,c as B,B as $,R as G,e as j,L as W,h as _,S as M,N as F,i as Y}from"./chunks/Settings-ge2d1G22.js";const O=({onLogout:t,onAddPassword:l,onViewPassword:c,onEditPassword:v,onSettings:o})=>{const u=C(),[h,y]=r.useState([]),[k,m]=r.useState(!0),[w,b]=r.useState(null),[p,P]=r.useState(""),[n,a]=r.useState(new Map);r.useEffect(()=>{d()},[]);const d=async()=>{try{m(!0),b(null);const s=localStorage.getItem("encryptionKey");if(console.log("ðŸ”‘ Encryption Key var mÄ±?",!!s),!s){b("Encryption key bulunamadÄ±. LÃ¼tfen yeniden giriÅŸ yapÄ±n."),m(!1);return}console.log("ðŸ“¥ Parolalar yÃ¼kleniyor...");const i=await I();console.log("âœ… API dÃ¶ndÃ¼, parola sayÄ±sÄ±:",i.length),y(i);const x=new Map;console.log("ðŸ”“ Decrypt iÅŸlemleri baÅŸlÄ±yor..."),await Promise.all(i.map(async g=>{try{const N=await L({encryptedName:g.encryptedName,encryptedUserName:g.encryptedUserName,encryptedPassword:g.encryptedPassword,encryptedDescription:g.encryptedDescription,encryptedWebSiteUrl:g.encryptedWebSiteUrl},s,g.iv);x.set(g.id,{name:N.name,websiteUrl:N.websiteUrl,username:N.username}),console.log(`âœ… ${N.name} decrypted baÅŸarÄ±lÄ±`)}catch(N){console.error(`âŒ Decrypt hatasÄ± (${g.id}):`,N.message||N)}})),console.log("âœ… TÃ¼m decrypt iÅŸlemleri tamamlandÄ±, toplam:",x.size),a(x),b(null)}catch(s){b("Parolalar yÃ¼klenemedi"),console.error(s)}finally{m(!1)}},S=r.useMemo(()=>{if(!p.trim())return h;const s=p.toLowerCase();return h.filter(i=>{const x=n.get(i.id);return x?x.name.toLowerCase().includes(s)||x.username.toLowerCase().includes(s)||x.websiteUrl.toLowerCase().includes(s):!1})},[h,p,n]),U=()=>{z(),t?(console.log("ðŸ“± Extension popup modunda - onLogout callback Ã§aÄŸrÄ±lÄ±yor"),t()):u("/login")},A=async s=>{if(window.confirm("Bu parolayÄ± silmek istediÄŸinize emin misiniz?"))try{await T({id:s}),y(h.filter(i=>i.id!==s))}catch(i){b("Silme iÅŸlemi baÅŸarÄ±sÄ±z"),console.error(i)}};return k&&h.length===0?e.jsx("div",{className:"loading",children:"YÃ¼kleniyor..."}):e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsx("h1",{children:"ParolalarÄ±m"}),e.jsxs("div",{className:"header-actions",children:[e.jsx("button",{onClick:()=>{o?o():u("/settings")},className:"btn btn-secondary",style:{marginRight:"8px"},title:"Ayarlar",children:"âš™ï¸"}),e.jsx("span",{className:"user-name",children:"ðŸ‘¤ KullanÄ±cÄ±"}),e.jsx("button",{onClick:U,className:"btn btn-logout",children:"Ã‡Ä±kÄ±ÅŸ Yap"})]})]}),e.jsxs("main",{className:"main",children:[e.jsx("div",{className:"actions",children:e.jsx("button",{onClick:()=>{l?l():u("/passwords/add")},className:"btn btn-primary",children:"+ Yeni Parola"})}),e.jsx("div",{className:"search-box",style:{marginBottom:"16px"},children:e.jsx("input",{type:"text",placeholder:"Parola ara... (ad, kullanÄ±cÄ± adÄ±, website)",value:p,onChange:s=>P(s.target.value),style:{width:"100%",padding:"12px 16px",borderRadius:"8px",border:"1px solid var(--border-color)",background:"var(--bg-input)",color:"var(--text-primary)",fontSize:"14px"}})}),w&&e.jsx("div",{className:"alert alert-error",children:w}),S.length===0?e.jsx("div",{className:"empty-state",children:p?e.jsxs("p",{children:['"',p,'" iÃ§in sonuÃ§ bulunamadÄ±']}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"HenÃ¼z parola eklememiÅŸsiniz"}),e.jsx("button",{onClick:()=>{l?l():u("/passwords/add")},className:"btn btn-primary",children:"Ä°lk parolayÄ± ekleyin"})]})}):e.jsx("div",{className:"password-grid",children:S.map(s=>{const i=n.get(s.id);return e.jsxs("div",{className:"password-card",children:[e.jsx("h3",{children:i?.name||"Parola"}),e.jsx("p",{className:"website",children:i?.websiteUrl||"-"}),e.jsxs("p",{className:"username",children:["KullanÄ±cÄ±: ",i?.username||"-"]}),e.jsxs("p",{className:"password-date",children:["OluÅŸturulma: ",D(s.createdDate)]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{onClick:()=>{c?c(s.id):u(`/passwords/${s.id}`)},className:"btn btn-small btn-info",children:"GÃ¶rÃ¼ntÃ¼le"}),e.jsx("button",{onClick:()=>{v?v(s.id):u(`/passwords/${s.id}/edit`)},className:"btn btn-small btn-warning",children:"DÃ¼zenle"}),e.jsx("button",{onClick:()=>A(s.id),className:"btn btn-small btn-danger",children:"Sil"})]})]},s.id)})}),e.jsxs("div",{style:{textAlign:"center",marginTop:"16px",color:"var(--text-muted)",fontSize:"13px"},children:["Toplam: ",h.length," parola ",p&&`(${S.length} sonuÃ§)`]})]})]})},H=()=>e.jsx(K,{}),Q=()=>{const{id:t}=R(),l=C(),[c,v]=r.useState(null),[o,u]=r.useState(null),[h,y]=r.useState(!0),[k,m]=r.useState(null),[w,b]=r.useState(!1);r.useEffect(()=>{t&&p()},[t]);const p=async()=>{try{y(!0),m(null);const n=localStorage.getItem("encryptionKey");if(console.log("ðŸ”‘ Encryption Key var mÄ±?",!!n),!n){m("Encryption key bulunamadÄ±. LÃ¼tfen yeniden giriÅŸ yapÄ±n."),y(!1);return}console.log("ðŸ“¥ Parola yÃ¼kleniyor, ID:",t);const a=await B(t);if(console.log("âœ… API dÃ¶ndÃ¼ (RAW):",{id:a.id,encryptedNameLength:a.encryptedName?.length,encryptedPasswordLength:a.encryptedPassword?.length,iv:a.iv,ivLength:a.iv?.length,ivType:typeof a.iv}),v(a),!a.iv){console.warn("âš ï¸ IV BULUNAMADI - Eski ÅŸifreleme mi? Backward compat gerekli olabilir"),m("Bu parola yeni format ile kaydedilmemiÅŸ. Admin ile iletiÅŸim kurun."),y(!1);return}console.log("ðŸ”“ Decrypt iÅŸlemi baÅŸlÄ±yor..."),console.log("ðŸ“‹ Decrypt parametreleri:",{encryptedNameLength:a.encryptedName.length,encryptionKeyLength:n.length,ivLength:a.iv.length});try{const d=await L({encryptedName:a.encryptedName,encryptedUserName:a.encryptedUserName,encryptedPassword:a.encryptedPassword,encryptedDescription:a.encryptedDescription,encryptedWebSiteUrl:a.encryptedWebSiteUrl},n,a.iv);console.log("âœ… Decrypt baÅŸarÄ±lÄ±:",d),u(d)}catch(d){console.error("âŒ Decrypt hatasÄ±:",d),console.error("Hata detayÄ±:",{message:d.message,name:d.name,stack:d.stack?.split(`
`).slice(0,3)}),m(`Åžifre Ã§Ã¶zme baÅŸarÄ±sÄ±z: ${d.message}`),y(!1);return}}catch(n){console.error("âŒ Parola yÃ¼kleme hatasÄ±:",n),m(`Parola yÃ¼klenemedi: ${n.message||n}`)}finally{y(!1)}},P=n=>{navigator.clipboard.writeText(n),alert("KopyalandÄ±!")};return h?e.jsx("div",{className:"loading",children:"YÃ¼kleniyor..."}):k||!c?e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"alert alert-error",children:k||"Parola bulunamadÄ±"}),e.jsx("button",{onClick:()=>l("/"),className:"btn btn-primary",children:"Geri DÃ¶n"})]}):e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsx("button",{onClick:()=>l("/"),className:"btn btn-back",children:"â† Geri"}),e.jsx("h1",{children:o?.name||"Parola"})]}),e.jsxs("main",{className:"main",children:[e.jsxs("div",{className:"password-details",children:[e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"Website"}),e.jsx("p",{children:o?.websiteUrl||"-"})]}),e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"KullanÄ±cÄ± AdÄ±"}),e.jsxs("div",{className:"detail-with-action",children:[e.jsx("p",{children:o?.username||"-"}),e.jsx("button",{onClick:()=>P(o?.username||""),className:"btn btn-small",children:"Kopyala"})]})]}),e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"Parola"}),e.jsxs("div",{className:"detail-with-action",children:[e.jsx("p",{children:w?o?.password:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("button",{onClick:()=>b(!w),className:"btn btn-small",children:w?"Gizle":"GÃ¶ster"}),e.jsx("button",{onClick:()=>P(o?.password||""),className:"btn btn-small",children:"Kopyala"})]})]}),o?.description&&e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("p",{children:o.description})]}),e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"OluÅŸturulma Tarihi"}),e.jsx("p",{children:D(c.createdDate)})]}),c.updatedDate&&e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"Son GÃ¼ncellenme Tarihi"}),e.jsx("p",{children:D(c.updatedDate)})]})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{onClick:()=>l(`/passwords/${t}/edit`),className:"btn btn-warning",children:"DÃ¼zenle"}),e.jsx("button",{onClick:()=>l("/"),className:"btn btn-secondary",children:"Kapat"})]})]})]})},q=()=>{const t=C();return e.jsx("div",{className:"container",children:e.jsxs("div",{className:"not-found",children:[e.jsx("h1",{children:"404"}),e.jsx("p",{children:"Sayfa bulunamadÄ±"}),e.jsx("button",{onClick:()=>t("/"),className:"btn btn-primary",children:"Ana Sayfaya DÃ¶n"})]})})},f=({children:t})=>localStorage.getItem("authToken")?e.jsx(e.Fragment,{children:t}):e.jsx(F,{to:"/login",replace:!0}),V=()=>e.jsx($,{children:e.jsxs(G,{children:[e.jsx(j,{path:"/login",element:e.jsx(W,{})}),e.jsx(j,{path:"/register",element:e.jsx(_,{})}),e.jsx(j,{path:"/",element:e.jsx(f,{children:e.jsx(O,{})})}),e.jsx(j,{path:"/passwords/add",element:e.jsx(f,{children:e.jsx(K,{})})}),e.jsx(j,{path:"/passwords/:id",element:e.jsx(f,{children:e.jsx(Q,{})})}),e.jsx(j,{path:"/passwords/:id/edit",element:e.jsx(f,{children:e.jsx(H,{})})}),e.jsx(j,{path:"/settings",element:e.jsx(f,{children:e.jsx(M,{})})}),e.jsx(j,{path:"*",element:e.jsx(q,{})})]})}),E=()=>{const t=localStorage.getItem("encryptionKey"),l=localStorage.getItem("authToken"),c=localStorage.getItem("userName");return{encryptionKey:{exists:!!t,length:t?.length,preview:t?.substring(0,32)+"..."},authToken:{exists:!!l,preview:l?.substring(0,32)+"..."},userName:{exists:!!c,value:c},allKeys:Object.keys(localStorage)}};typeof window<"u"&&(window.__debugCrypto=E);typeof window<"u"&&(window.__debugCrypto=E,console.log("ðŸ’¡ Debug mode: console'da __debugCrypto() Ã§aÄŸÄ±rarak state kontrol edebilirsin"));function J(){return e.jsx("div",{className:"app",children:e.jsx(V,{})})}Y.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(J,{})}));
