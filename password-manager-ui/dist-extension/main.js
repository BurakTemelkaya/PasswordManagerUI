import{u as K,r as t,g as _,d as L,j as e,f as C,l as F,a as M,A as z,b as Y,c as O,B as H,R as V,e as x,L as q,h as J,N as Q,i as X}from"./chunks/AddPassword-B8O4tx2X.js";const Z=({onLogout:n,onAddPassword:i,onViewPassword:d,onEditPassword:N})=>{const r=K(),[j,v]=t.useState([]),[y,b]=t.useState(!0),[h,p]=t.useState(null),[w,k]=t.useState(new Map),[c,l]=t.useState(0),[s,m]=t.useState(10),[P,I]=t.useState(1),[T,U]=t.useState(0);t.useEffect(()=>{A()},[c,s]);const A=async()=>{try{b(!0),p(null);const a=localStorage.getItem("encryptionKey");if(console.log("ðŸ”‘ Encryption Key var mÄ±?",!!a),!a){p("Encryption key bulunamadÄ±. LÃ¼tfen yeniden giriÅŸ yapÄ±n."),b(!1);return}console.log("ðŸ“¥ Parolalar yÃ¼kleniyor...");const o=await _(c,s),S=o.items||[];console.log("âœ… API dÃ¶ndÃ¼, parola sayÄ±sÄ±:",S.length),v(S),I(o.pages),U(o.count);const D=new Map;console.log("ðŸ”“ Decrypt iÅŸlemleri baÅŸlÄ±yor..."),await Promise.all(S.map(async u=>{try{const g=await L({encryptedName:u.encryptedName,encryptedUserName:u.encryptedUserName,encryptedPassword:u.encryptedPassword,encryptedDescription:u.encryptedDescription,encryptedWebSiteUrl:u.encryptedWebSiteUrl},a,u.iv);D.set(u.id,{name:g.name,websiteUrl:g.websiteUrl,username:g.username}),console.log(`âœ… ${g.name} decrypted baÅŸarÄ±lÄ±`)}catch(g){console.error(`âŒ Decrypt hatasÄ± (${u.id}):`,g.message||g)}})),console.log("âœ… TÃ¼m decrypt iÅŸlemleri tamamlandÄ±, toplam:",D.size),k(D),p(null)}catch(a){p("Parolalar yÃ¼klenemedi"),console.error(a)}finally{b(!1)}},R=()=>{F(),n?(console.log("ðŸ“± Extension popup modunda - onLogout callback Ã§aÄŸrÄ±lÄ±yor"),n()):r("/login")},B=async a=>{if(window.confirm("Bu parolayÄ± silmek istediÄŸinize emin misiniz?"))try{await M({id:a}),v(j.filter(o=>o.id!==a))}catch(o){p("Silme iÅŸlemi baÅŸarÄ±sÄ±z"),console.error(o)}},$=()=>{c<P-1&&l(c+1)},G=()=>{c>0&&l(c-1)},W=a=>{m(Number(a.target.value)),l(0)};return y&&j.length===0?e.jsx("div",{className:"loading",children:"YÃ¼kleniyor..."}):e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsx("h1",{children:"ParolalarÄ±m"}),e.jsxs("div",{className:"header-actions",children:[e.jsx("span",{className:"user-name",children:"ðŸ‘¤ KullanÄ±cÄ±"}),e.jsx("button",{onClick:R,className:"btn btn-logout",children:"Ã‡Ä±kÄ±ÅŸ Yap"})]})]}),e.jsxs("main",{className:"main",children:[e.jsx("div",{className:"actions",children:e.jsx("button",{onClick:()=>{i?i():r("/passwords/add")},className:"btn btn-primary",children:"+ Yeni Parola"})}),h&&e.jsx("div",{className:"alert alert-error",children:h}),j.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("p",{children:"HenÃ¼z parola eklememiÅŸsiniz"}),e.jsx("button",{onClick:()=>{i?i():r("/passwords/add")},className:"btn btn-primary",children:"Ä°lk parolayÄ± ekleyin"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"password-grid",children:j.map(a=>{const o=w.get(a.id);return e.jsxs("div",{className:"password-card",children:[e.jsx("h3",{children:o?.name||"Parola"}),e.jsx("p",{className:"website",children:o?.websiteUrl||"-"}),e.jsxs("p",{className:"username",children:["KullanÄ±cÄ±: ",o?.username||"-"]}),e.jsxs("p",{className:"password-date",children:["OluÅŸturulma: ",C(a.createdDate)]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{onClick:()=>{d?d(a.id):r(`/passwords/${a.id}`)},className:"btn btn-small btn-info",children:"GÃ¶rÃ¼ntÃ¼le"}),e.jsx("button",{onClick:()=>{N?N(a.id):r(`/passwords/${a.id}/edit`)},className:"btn btn-small btn-warning",children:"DÃ¼zenle"}),e.jsx("button",{onClick:()=>B(a.id),className:"btn btn-small btn-danger",children:"Sil"})]})]},a.id)})}),e.jsxs("div",{className:"pagination",children:[e.jsxs("div",{className:"pagination-info",children:[e.jsxs("span",{children:["Sayfa ",c+1," / ",P," (Toplam: ",T," parola)"]}),e.jsxs("select",{value:s,onChange:W,className:"page-size-select",children:[e.jsx("option",{value:"5",children:"5 baÅŸÄ±na"}),e.jsx("option",{value:"10",children:"10 baÅŸÄ±na"}),e.jsx("option",{value:"20",children:"20 baÅŸÄ±na"}),e.jsx("option",{value:"50",children:"50 baÅŸÄ±na"})]})]}),e.jsxs("div",{className:"pagination-buttons",children:[e.jsx("button",{onClick:G,disabled:c===0,className:"btn btn-secondary",children:"â† Ã–nceki"}),e.jsx("button",{onClick:$,disabled:c===P-1,className:"btn btn-secondary",children:"Sonraki â†’"})]})]})]})]})]})},ee=()=>e.jsx(z,{}),se=()=>{const{id:n}=Y(),i=K(),[d,N]=t.useState(null),[r,j]=t.useState(null),[v,y]=t.useState(!0),[b,h]=t.useState(null),[p,w]=t.useState(!1);t.useEffect(()=>{n&&k()},[n]);const k=async()=>{try{y(!0),h(null);const l=localStorage.getItem("encryptionKey");if(console.log("ðŸ”‘ Encryption Key var mÄ±?",!!l),!l){h("Encryption key bulunamadÄ±. LÃ¼tfen yeniden giriÅŸ yapÄ±n."),y(!1);return}console.log("ðŸ“¥ Parola yÃ¼kleniyor, ID:",n);const s=await O(n);if(console.log("âœ… API dÃ¶ndÃ¼ (RAW):",{id:s.id,encryptedNameLength:s.encryptedName?.length,encryptedPasswordLength:s.encryptedPassword?.length,iv:s.iv,ivLength:s.iv?.length,ivType:typeof s.iv}),N(s),!s.iv){console.warn("âš ï¸ IV BULUNAMADI - Eski ÅŸifreleme mi? Backward compat gerekli olabilir"),h("Bu parola yeni format ile kaydedilmemiÅŸ. Admin ile iletiÅŸim kurun."),y(!1);return}console.log("ðŸ”“ Decrypt iÅŸlemi baÅŸlÄ±yor..."),console.log("ðŸ“‹ Decrypt parametreleri:",{encryptedNameLength:s.encryptedName.length,encryptionKeyLength:l.length,ivLength:s.iv.length});try{const m=await L({encryptedName:s.encryptedName,encryptedUserName:s.encryptedUserName,encryptedPassword:s.encryptedPassword,encryptedDescription:s.encryptedDescription,encryptedWebSiteUrl:s.encryptedWebSiteUrl},l,s.iv);console.log("âœ… Decrypt baÅŸarÄ±lÄ±:",m),j(m)}catch(m){console.error("âŒ Decrypt hatasÄ±:",m),console.error("Hata detayÄ±:",{message:m.message,name:m.name,stack:m.stack?.split(`
`).slice(0,3)}),h(`Åžifre Ã§Ã¶zme baÅŸarÄ±sÄ±z: ${m.message}`),y(!1);return}}catch(l){console.error("âŒ Parola yÃ¼kleme hatasÄ±:",l),h(`Parola yÃ¼klenemedi: ${l.message||l}`)}finally{y(!1)}},c=l=>{navigator.clipboard.writeText(l),alert("KopyalandÄ±!")};return v?e.jsx("div",{className:"loading",children:"YÃ¼kleniyor..."}):b||!d?e.jsxs("div",{className:"container",children:[e.jsx("div",{className:"alert alert-error",children:b||"Parola bulunamadÄ±"}),e.jsx("button",{onClick:()=>i("/"),className:"btn btn-primary",children:"Geri DÃ¶n"})]}):e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"header",children:[e.jsx("button",{onClick:()=>i("/"),className:"btn btn-back",children:"â† Geri"}),e.jsx("h1",{children:r?.name||"Parola"})]}),e.jsxs("main",{className:"main",children:[e.jsxs("div",{className:"password-details",children:[e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"Website"}),e.jsx("p",{children:r?.websiteUrl||"-"})]}),e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"KullanÄ±cÄ± AdÄ±"}),e.jsxs("div",{className:"detail-with-action",children:[e.jsx("p",{children:r?.username||"-"}),e.jsx("button",{onClick:()=>c(r?.username||""),className:"btn btn-small",children:"Kopyala"})]})]}),e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"Parola"}),e.jsxs("div",{className:"detail-with-action",children:[e.jsx("p",{children:p?r?.password:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("button",{onClick:()=>w(!p),className:"btn btn-small",children:p?"Gizle":"GÃ¶ster"}),e.jsx("button",{onClick:()=>c(r?.password||""),className:"btn btn-small",children:"Kopyala"})]})]}),r?.description&&e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"AÃ§Ä±klama"}),e.jsx("p",{children:r.description})]}),e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"OluÅŸturulma Tarihi"}),e.jsx("p",{children:C(d.createdDate)})]}),d.updatedDate&&e.jsxs("div",{className:"detail-group",children:[e.jsx("label",{children:"Son GÃ¼ncellenme Tarihi"}),e.jsx("p",{children:C(d.updatedDate)})]})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{onClick:()=>i(`/passwords/${n}/edit`),className:"btn btn-warning",children:"DÃ¼zenle"}),e.jsx("button",{onClick:()=>i("/"),className:"btn btn-secondary",children:"Kapat"})]})]})]})},ae=()=>{const n=K();return e.jsx("div",{className:"container",children:e.jsxs("div",{className:"not-found",children:[e.jsx("h1",{children:"404"}),e.jsx("p",{children:"Sayfa bulunamadÄ±"}),e.jsx("button",{onClick:()=>n("/"),className:"btn btn-primary",children:"Ana Sayfaya DÃ¶n"})]})})},f=({children:n})=>localStorage.getItem("authToken")?e.jsx(e.Fragment,{children:n}):e.jsx(Q,{to:"/login",replace:!0}),ne=()=>e.jsx(H,{children:e.jsxs(V,{children:[e.jsx(x,{path:"/login",element:e.jsx(q,{})}),e.jsx(x,{path:"/register",element:e.jsx(J,{})}),e.jsx(x,{path:"/",element:e.jsx(f,{children:e.jsx(Z,{})})}),e.jsx(x,{path:"/passwords/add",element:e.jsx(f,{children:e.jsx(z,{})})}),e.jsx(x,{path:"/passwords/:id",element:e.jsx(f,{children:e.jsx(se,{})})}),e.jsx(x,{path:"/passwords/:id/edit",element:e.jsx(f,{children:e.jsx(ee,{})})}),e.jsx(x,{path:"*",element:e.jsx(ae,{})})]})}),E=()=>{const n=localStorage.getItem("encryptionKey"),i=localStorage.getItem("authToken"),d=localStorage.getItem("userName");return{encryptionKey:{exists:!!n,length:n?.length,preview:n?.substring(0,32)+"..."},authToken:{exists:!!i,preview:i?.substring(0,32)+"..."},userName:{exists:!!d,value:d},allKeys:Object.keys(localStorage)}};typeof window<"u"&&(window.__debugCrypto=E);typeof window<"u"&&(window.__debugCrypto=E,console.log("ðŸ’¡ Debug mode: console'da __debugCrypto() Ã§aÄŸÄ±rarak state kontrol edebilirsin"));function te(){return e.jsx("div",{className:"app",children:e.jsx(ne,{})})}X.createRoot(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx(te,{})}));
